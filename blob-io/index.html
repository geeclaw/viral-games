<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blob Conquest</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@500;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 50%,#0f3460 100%);min-height:100vh;display:flex;justify-content:center;align-items:center;font-family:'Quicksand',sans-serif;overflow:hidden}
#gameContainer{position:relative;border-radius:16px;box-shadow:0 0 60px rgba(0,255,200,0.15),0 0 100px rgba(255,0,150,0.1),inset 0 0 60px rgba(0,0,0,0.3);background:rgba(0,0,0,0.4);padding:8px}
#gameCanvas{display:block;border-radius:12px;cursor:none}
#ui{position:absolute;top:20px;left:20px;right:20px;display:flex;justify-content:space-between;align-items:center;pointer-events:none}
.score-container,.leaderboard{background:rgba(0,0,0,0.6);backdrop-filter:blur(10px);border-radius:12px;padding:12px 20px;border:1px solid rgba(255,255,255,0.1)}
.score-label{font-size:12px;color:rgba(255,255,255,0.6);text-transform:uppercase;letter-spacing:2px}
.score-value{font-family:'Fredoka One',cursive;font-size:28px;color:#00ffc8;text-shadow:0 0 20px rgba(0,255,200,0.5)}
.leaderboard{min-width:180px}
.leaderboard-title{font-size:12px;color:rgba(255,255,255,0.6);text-transform:uppercase;letter-spacing:2px;margin-bottom:8px;text-align:center}
.leaderboard-entry{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:14px}
.leaderboard-color{width:12px;height:12px;border-radius:50%;box-shadow:0 0 8px currentColor}
.leaderboard-name{flex:1;color:#fff}
.leaderboard-percent{color:rgba(255,255,255,0.7);font-weight:700}
#notification{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Fredoka One',cursive;font-size:48px;color:#fff;text-shadow:0 0 30px rgba(255,0,100,0.8),0 0 60px rgba(255,0,100,0.4);opacity:0;pointer-events:none;transition:opacity 0.3s,transform 0.3s;text-align:center}
#notification.show{opacity:1;transform:translate(-50%,-50%) scale(1.1)}
#notification.kill{color:#00ffc8;text-shadow:0 0 30px rgba(0,255,200,0.8),0 0 60px rgba(0,255,200,0.4)}
#gameOver{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;flex-direction:column;justify-content:center;align-items:center;opacity:0;pointer-events:none;transition:opacity 0.5s;border-radius:12px}
#gameOver.show{opacity:1;pointer-events:all}
#gameOver h1{font-family:'Fredoka One',cursive;font-size:56px;color:#ff0064;text-shadow:0 0 40px rgba(255,0,100,0.6);margin-bottom:20px}
#gameOver .stats{font-size:24px;color:#fff;margin-bottom:30px;text-align:center}
#restartBtn{font-family:'Fredoka One',cursive;font-size:24px;padding:16px 48px;border:none;border-radius:50px;background:linear-gradient(135deg,#00ffc8 0%,#00b894 100%);color:#1a1a2e;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;box-shadow:0 0 30px rgba(0,255,200,0.4)}
#restartBtn:hover{transform:scale(1.05);box-shadow:0 0 50px rgba(0,255,200,0.6)}
#startScreen{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:12px;z-index:10}
#startScreen h1{font-family:'Fredoka One',cursive;font-size:64px;background:linear-gradient(135deg,#00ffc8 0%,#ff0064 50%,#ffd93d 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:20px}
#startScreen .subtitle{font-size:18px;color:rgba(255,255,255,0.6);margin-bottom:40px}
#startScreen .controls{color:rgba(255,255,255,0.5);font-size:14px;margin-bottom:30px;text-align:center;line-height:1.8}
#startBtn{font-family:'Fredoka One',cursive;font-size:28px;padding:20px 60px;border:none;border-radius:50px;background:linear-gradient(135deg,#ff0064 0%,#ff6b6b 100%);color:#fff;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;box-shadow:0 0 40px rgba(255,0,100,0.5);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
#startBtn:hover{transform:scale(1.1);box-shadow:0 0 60px rgba(255,0,100,0.8)}
.player-color-picker{margin-top:20px;display:flex;gap:10px}
.color-option{width:40px;height:40px;border-radius:50%;cursor:pointer;border:3px solid transparent;transition:transform 0.2s,border-color 0.2s}
.color-option:hover{transform:scale(1.1)}
.color-option.selected{border-color:#fff;box-shadow:0 0 20px currentColor}
</style>
</head>
<body>
<div id="gameContainer">
<canvas id="gameCanvas"></canvas>
<div id="ui">
<div class="score-container"><div class="score-label">Your Territory</div><div class="score-value" id="scoreDisplay">0%</div></div>
<div class="leaderboard"><div class="leaderboard-title">Leaderboard</div><div id="leaderboardEntries"></div></div>
</div>
<div id="notification"></div>
<div id="gameOver"><h1>GAME OVER</h1><div class="stats" id="gameOverStats"></div><button id="restartBtn">Play Again</button></div>
<div id="startScreen">
<h1>Blob Conquest</h1>
<div class="subtitle">Capture territory, dominate the arena!</div>
<div class="controls">Mouse to move<br>Draw loops to capture territory<br>Cut enemy trails to kill them<br>Don't get your trail cut!</div>
<div class="player-color-picker">
<div class="color-option selected" style="background:#00ffc8;color:#00ffc8;" data-color="#00ffc8"></div>
<div class="color-option" style="background:#ff6b6b;color:#ff6b6b;" data-color="#ff6b6b"></div>
<div class="color-option" style="background:#ffd93d;color:#ffd93d;" data-color="#ffd93d"></div>
<div class="color-option" style="background:#a855f7;color:#a855f7;" data-color="#a855f7"></div>
<div class="color-option" style="background:#3b82f6;color:#3b82f6;" data-color="#3b82f6"></div>
</div>
<button id="startBtn">START GAME</button>
</div>
</div>
<script>
const AudioContext=window.AudioContext||window.webkitAudioContext;let audioCtx=null;
function initAudio(){if(!audioCtx)audioCtx=new AudioContext()}
function playSound(type){if(!audioCtx)return;const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.connect(g);g.connect(audioCtx.destination);switch(type){case'capture':o.type='sine';o.frequency.setValueAtTime(400,audioCtx.currentTime);o.frequency.exponentialRampToValueAtTime(800,audioCtx.currentTime+0.1);g.gain.setValueAtTime(0.3,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+0.3);o.start();o.stop(audioCtx.currentTime+0.3);break;case'die':o.type='sawtooth';o.frequency.setValueAtTime(300,audioCtx.currentTime);o.frequency.exponentialRampToValueAtTime(50,audioCtx.currentTime+0.5);g.gain.setValueAtTime(0.3,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+0.5);o.start();o.stop(audioCtx.currentTime+0.5);break;case'kill':o.type='square';o.frequency.setValueAtTime(200,audioCtx.currentTime);o.frequency.exponentialRampToValueAtTime(600,audioCtx.currentTime+0.15);o.frequency.exponentialRampToValueAtTime(400,audioCtx.currentTime+0.3);g.gain.setValueAtTime(0.2,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+0.4);o.start();o.stop(audioCtx.currentTime+0.4);break}}
const CONFIG={ARENA_WIDTH:1200,ARENA_HEIGHT:900,PLAYER_RADIUS:18,TRAIL_WIDTH:8,PLAYER_SPEED:5,ENEMY_COUNT:6,RESPAWN_DELAY:2000,GRID_SIZE:6};
const ENEMY_COLORS=['#ff6b6b','#ffd93d','#a855f7','#3b82f6','#f97316','#ec4899'];
let canvas,ctx,gameRunning=false,player,enemies,particles,territory;
let mouseX=CONFIG.ARENA_WIDTH/2,mouseY=CONFIG.ARENA_HEIGHT/2,playerColor='#00ffc8',killCount=0,deaths=0,currentNotification=null,territoryUpdateTimer=0;
function init(){canvas=document.getElementById('gameCanvas');ctx=canvas.getContext('2d');canvas.width=CONFIG.ARENA_WIDTH;canvas.height=CONFIG.ARENA_HEIGHT;const c=document.getElementById('gameContainer');c.style.width=(CONFIG.ARENA_WIDTH+16)+'px';c.style.height=(CONFIG.ARENA_HEIGHT+16)+'px';canvas.addEventListener('mousemove',e=>{const r=canvas.getBoundingClientRect();const sx=CONFIG.ARENA_WIDTH/r.width;const sy=CONFIG.ARENA_HEIGHT/r.height;mouseX=(e.clientX-r.left)*sx;mouseY=(e.clientY-r.top)*sy});canvas.addEventListener('touchmove',e=>{e.preventDefault();const r=canvas.getBoundingClientRect();const sx=CONFIG.ARENA_WIDTH/r.width;const sy=CONFIG.ARENA_HEIGHT/r.height;mouseX=(e.touches[0].clientX-r.left)*sx;mouseY=(e.touches[0].clientY-r.top)*sy},{passive:false});document.querySelectorAll('.color-option').forEach(o=>o.addEventListener('click',()=>{document.querySelectorAll('.color-option').forEach(x=>x.classList.remove('selected'));o.classList.add('selected');playerColor=o.dataset.color}));document.getElementById('startBtn').addEventListener('click',startGame);document.getElementById('restartBtn').addEventListener('click',startGame);renderStartScreen()}
function renderStartScreen(){ctx.fillStyle='#0a0a1a';ctx.fillRect(0,0,CONFIG.ARENA_WIDTH,CONFIG.ARENA_HEIGHT);ctx.strokeStyle='rgba(255,255,255,0.03)';ctx.lineWidth=1;for(let x=0;x<CONFIG.ARENA_WIDTH;x+=30){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,CONFIG.ARENA_HEIGHT);ctx.stroke()}for(let y=0;y<CONFIG.ARENA_HEIGHT;y+=30){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(CONFIG.ARENA_WIDTH,y);ctx.stroke()}}
function startGame(){initAudio();document.getElementById('startScreen').style.display='none';killCount=0;deaths=0;initTerritory();player={x:CONFIG.ARENA_WIDTH/2,y:CONFIG.ARENA_HEIGHT/2,vx:0,vy:0,radius:CONFIG.PLAYER_RADIUS,color:playerColor,trail:[],score:0,alive:true,name:'You',isPlayer:true};enemies=[];for(let i=0;i<CONFIG.ENEMY_COUNT;i++)createEnemy(i);particles=[];gameRunning=true;requestAnimationFrame(gameLoop)}
function initTerritory(){territory=[];for(let y=0;y<CONFIG.ARENA_HEIGHT;y+=CONFIG.GRID_SIZE){territory[y/CONFIG.GRID_SIZE]=[];for(let x=0;x<CONFIG.ARENA_WIDTH;x+=CONFIG.GRID_SIZE)territory[y/CONFIG.GRID_SIZE][x/CONFIG.GRID_SIZE]=null}}
function createEnemy(index){const m=100;let x,y,valid;do{x=m+Math.random()*(CONFIG.ARENA_WIDTH-m*2);y=m+Math.random()*(CONFIG.ARENA_HEIGHT-m*2);valid=true;if(player&&player.alive){const dx=x-player.x,dy=y-player.y;if(Math.sqrt(dx*dx+dy*dy)<200)valid=false}for(const e of enemies){const dx=x-e.x,dy=y-e.y;if(Math.sqrt(dx*dx+dy*dy)<150)valid=false}}while(!valid);const n=['Blobber','Chomp','Snappy','Gloop','Blobby','Chomp'];enemies.push({x,y,vx:0,vy:0,radius:CONFIG.PLAYER_RADIUS,color:ENEMY_COLORS[index%ENEMY_COLORS.length],trail:[],score:0,alive:true,name:n[index%n.length],isPlayer:false,targetX:x,targetY:y,changeTimer:0,speed:3+Math.random()*2})}
function gameLoop(t){if(!gameRunning)return;update(t);render();requestAnimationFrame(gameLoop)}
function update(t){if(player.alive)updateBlob(player,true);enemies.forEach(e=>{if(e.alive){updateEnemyAI(e);updateBlob(e,false)}});checkCollisions();updateParticles();territoryUpdateTimer+=16;if(territoryUpdateTimer>=100){territoryUpdateTimer=0;updateTerritory()}updateScores();updateLeaderboard()}
function updateBlob(b,isPlayer){const tx=isPlayer?mouseX:b.targetX,ty=isPlayer?mouseY:b.targetY;const dx=tx-b.x,dy=ty-b.y,dist=Math.sqrt(dx*dx+dy*dy);if(dist>5){const spd=isPlayer?CONFIG.PLAYER_SPEED:b.speed;b.vx+=dx/dist*0.5;b.vy+=dy/dist*0.5;const v=Math.sqrt(b.vx*b.vx+b.vy*b.vy);if(v>spd){b.vx=b.vx/v*spd;b.vy=b.vy/v*spd}}b.vx*=0.92;b.vy*=0.92;b.x+=b.vx;b.y+=b.vy;b.x=Math.max(b.radius,Math.min(CONFIG.ARENA_WIDTH-b.radius,b.x));b.y=Math.max(b.radius,Math.min(CONFIG.ARENA_HEIGHT-b.radius,b.y));const lt=b.trail[b.trail.length-1];if(!lt||Math.hypot(b.x-lt.x,b.y-lt.y)>8){b.trail.push({x:b.x,y:b.y,time:Date.now()});if(b.trail.length>300)b.trail.shift()}}
function updateEnemyAI(e){e.changeTimer--;if(e.changeTimer<=0){const b=Math.random();if(b<0.4){e.targetX=50+Math.random()*(CONFIG.ARENA_WIDTH-100);e.targetY=50+Math.random()*(CONFIG.ARENA_HEIGHT-100)}else if(b<0.7){const gx=Math.floor(e.x/CONFIG.GRID_SIZE),gy=Math.floor(e.y/CONFIG.GRID_SIZE);for(let r=1;r<20;r++){for(let dx=-r;dx<=r;dx++){for(let dy=-r;dy<=r;dy++){const nx=gx+dx,ny=gy+dy;if(nx>=0&&ny>=0&&nx<CONFIG.ARENA_WIDTH/CONFIG.GRID_SIZE&&ny<CONFIG.ARENA_HEIGHT/CONFIG.GRID_SIZE&&(!territory[ny]||!territory[ny][nx])){e.targetX=nx*CONFIG.GRID_SIZE+CONFIG.GRID_SIZE/2;e.targetY=ny*CONFIG.GRID_SIZE+CONFIG.GRID_SIZE/2;break}}}}}}else{if(player.alive){const dx=player.x-e.x,dy=player.y-e.y,dist=Math.sqrt(dx*dx+dy*dy);if(dist<250){e.targetX=player.x;e.targetY=player.y}else{e.targetX=50+Math.random()*(CONFIG.ARENA_WIDTH-100);e.targetY=50+Math.random()*(CONFIG.ARENA_HEIGHT-100)}}}e.changeTimer=60+Math.random()*120}}
function checkCollisions(){if(!player.alive)return;enemies.forEach(e=>{if(!e.alive)return;const dx=player.x-e.x,dy=player.y-e.y,d=Math.sqrt(dx*dx+dy*dy);if(d>150)return;for(let i=0;i<player.trail.length-10;i++){const t=player.trail[i],td=Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2);if(td<e.radius+CONFIG.TRAIL_WIDTH){killEnemy(e);return}}for(let i=0;i<e.trail.length-10;i++){const t=e.trail[i],td=Math.sqrt((player.x-t.x)**2+(player.y-t.y)**2);if(td<player.radius+CONFIG.TRAIL_WIDTH){killPlayer(e);return}}if(d<player.radius+e.radius){killPlayer(e);killEnemy(e)}});for(let i=0;i<enemies.length;i++)for(let j=0;j<enemies.length;j++){if(i===j||!enemies[i].alive||!enemies[j].alive)continue;const d=Math.sqrt((enemies[i].x-enemies[j].x)**2+(enemies[i].y-enemies[j].y)**2);if(d>100)continue;for(let t=0;t<enemies[j].trail.length-10;t++){const tr=enemies[j].trail[t],td=Math.sqrt((enemies[i].x-tr.x)**2+(enemies[i].y-tr.y)**2);if(td<enemies[i].radius+CONFIG.TRAIL_WIDTH){killEnemy(enemies[j]);if(player.alive)showNotification(enemies[i].name+' killed '+enemies[j].name+'!','kill');break}}}}
function killPlayer(k){player.alive=false;deaths++;playSound('die');createParticles(player.x,player.y,player.color,30);captureTerritory(player);showNotification('You Died!','die');setTimeout(()=>{if(gameRunning)respawnPlayer()},CONFIG.RESPAWN_DELAY)}
function killEnemy(e){e.alive=false;killCount++;playSound('kill');createParticles(e.x,e.y,e.color,30);captureTerritory(e);showNotification('You killed '+e.name+'!','kill');setTimeout(()=>{if(gameRunning){const i=enemies.indexOf(e);enemies.splice(i,1);createEnemy(i)}},CONFIG.RESPAWN_DELAY)}
function respawnPlayer(){let x,y,valid;do{x=50+Math.random()*(CONFIG.ARENA_WIDTH-100);y=50+Math.random()*(CONFIG.ARENA_HEIGHT-100);valid=true;for(const e of enemies){if(!e.alive)continue;const dx=x-e.x,dy=y-e.y;if(Math.sqrt(dx*dx+dy*dy)<200)valid=false}}while(!valid);player.x=x;player.y=y;player.vx=0;player.vy=0;player.trail=[];player.alive=true}
function captureTerritory(blob){if(blob.trail.length<10)return;const pts=blob.trail.map(t=>({x:t.x,y:t.y}));pts.push({x:blob.x,y:blob.y});let minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity;for(const p of pts){minX=Math.min(minX,p.x);maxX=Math.max(maxX,p.x);minY=Math.min(minY,p.y);maxY=Math.max(maxY,p.y)}minX=Math.max(0,Math.floor((minX-20)/CONFIG.GRID_SIZE));maxX=Math.min(CONFIG.ARENA_WIDTH/CONFIG.GRID_SIZE-1,Math.ceil((maxX+20)/CONFIG.GRID_SIZE));minY=Math.max(0,Math.floor((minY-20)/CONFIG.GRID_SIZE));maxY=Math.min(CONFIG.ARENA_HEIGHT/CONFIG.GRID_SIZE-1,Math.ceil((maxY+20)/CONFIG.GRID_SIZE));for(let gy=minY;gy<=maxY;gy++){const ints=[];for(let i=0;i<pts.length;i++){const p1=pts[i],p2=pts[(i+1)%pts.length];if((p1.y<=gy*CONFIG.GRID_SIZE&&p2.y>gy*CONFIG.GRID_SIZE)||(p2.y<=gy*CONFIG.GRID_SIZE&&p1.y>gy*CONFIG.GRID_SIZE)){const x=(p2.x-p1.x)*(gy*CONFIG.GRID_SIZE-p1.y)/(p2.y-p1.y)+p1.x;ints.push(x/CONFIG.GRID_SIZE)}}ints.sort((a,b)=>a-b);for(let i=0;i<ints.length-1;i+=2)for(let gx=Math.floor(ints[i]);gx<=Math.ceil(ints[i+1]);gx++){if(gx>=0&&gx<CONFIG.ARENA_WIDTH/CONFIG.GRID_SIZE&&gy>=0&&gy<CONFIG.ARENA_HEIGHT/CONFIG.GRID_SIZE)territory[gy][gx]=blob.color}}playSound('capture');createParticles(blob.x,blob.y,blob.color,20)}
function updateTerritory(){}
function createParticles(x,y,c,n){for(let i=0;i<n;i++){const a=Math.random()*Math.PI*2,s=2+Math.random()*4;particles.push({x,y,vx:Math.cos(a)*s,vy:Math.sin(a)*s,color:c,life:1,decay:0.02+Math.random()*0.02,size:3+Math.random()*4})}}
function updateParticles(){for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.x+=p.vx;p.y+=p.vy;p.vx*=0.96;p.vy*=0.96;p.life-=p.decay;if(p.life<=0)particles.splice(i,1)}}
function showNotification(txt,type){const n=document.getElementById('notification');n.textContent=txt;n.className='show '+type;if(currentNotification)clearTimeout(currentNotification);currentNotification=setTimeout(()=>{n.className='';currentNotification=null},1500)}
function updateScores(){if(!territory)return;const tc=(CONFIG.ARENA_WIDTH/CONFIG.GRID_SIZE)*(CONFIG.ARENA_HEIGHT/CONFIG.GRID_SIZE);let pc=0;for(let y=0;y<territory.length;y++)for(let x=0;x<territory[y].length;x++)if(territory[y][x]===player.color)pc++;const sc=Math.round((pc/tc)*100);player.score=sc;document.getElementById('scoreDisplay').textContent=sc+'%'}
function updateLeaderboard(){if(!territory)return;const scs=[];scs.push({name:'You',color:player.color,score:player.score});const cc={};for(let y=0;y<territory.length;y++)for(let x=0;x<territory[y].length;x++){const c=territory[y][x];if(c)cc[c]=(cc[c]||0)+1}const tc=(CONFIG.ARENA_WIDTH/CONFIG.GRID_SIZE)*(CONFIG.ARENA_HEIGHT/CONFIG.GRID_SIZE);enemies.forEach(e=>{const cnt=cc[e.color]||0;scs.push({name:e.name,color:e.color,score:Math.round((cnt/tc)*100)})});scs.sort((a,b)=>b.score-a.score);const el=document.getElementById('leaderboardEntries');el.innerHTML=scs.slice(0,5).map(s=>'<div class="leaderboard-entry"><div class="leaderboard-color" style="background:'+s.color+';color:'+s.color+'"></div><div class="leaderboard-name">'+s.name+'</div><div class="leaderboard-percent">'+s.score+'%</div></div>').join('')}
function render(){ctx.fillStyle='#0a0a1a';ctx.fillRect(0,0,CONFIG.ARENA_WIDTH,CONFIG.ARENA_HEIGHT);ctx.strokeStyle='rgba(255,255,255,0.03)';ctx.lineWidth=1;for(let x=0;x<CONFIG.ARENA_WIDTH;x+=30){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,CONFIG.ARENA_HEIGHT);ctx.stroke()}for(let y=0;y<CONFIG.ARENA_HEIGHT;y+=30){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(CONFIG.ARENA_WIDTH,y);ctx.stroke()}for(let y=0;y<territory.length;y++)for(let x=0;x<territory[y].length;x++)if(territory[y][x]){ctx.fillStyle=territory[y][x]+'40';ctx.fillRect(x*CONFIG.GRID_SIZE,y*CONFIG.GRID_SIZE,CONFIG.GRID_SIZE,CONFIG.GRID_SIZE)}if(player.alive)drawTrail(player.trail,player.color);enemies.forEach(e=>{if(e.alive)drawTrail(e.trail,e.color)});if(player.alive)drawBlob(player);enemies.forEach(e=>{if(e.alive)drawBlob(e)});particles.forEach(p=>{ctx.globalAlpha=p.life;ctx.fillStyle=p.color;ctx.beginPath();ctx.arc(p.x,p.y,p.size*p.life,0,Math.PI*2);ctx.fill()});ctx.globalAlpha=1}
function drawTrail(t,c){if(t.length<2)return;ctx.strokeStyle=c;ctx.lineWidth=CONFIG.TRAIL_WIDTH;ctx.lineCap='round';ctx.lineJoin='round';ctx.shadowColor=c;ctx.shadowBlur=10;ctx.beginPath();ctx.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)ctx.lineTo(t[i].x,t[i].y);ctx.stroke();ctx.shadowBlur=0}
function drawBlob(b){ctx.shadowColor=b.color;ctx.shadowBlur=20;ctx.fillStyle=b.color;ctx.beginPath();ctx.arc(b.x,b.y,b.radius,0,Math.PI*2);ctx.fill();ctx.shadowBlur=0;ctx.fillStyle='rgba(255,255,255,0.3)';ctx.beginPath();ctx.arc(b.x-b.radius*0.3,b.y-b.radius*0.3,b.radius*0.3,0,Math.PI*2);ctx.fill()}
init();
</script>
</body>
</html>